tinymce.PluginManager.add("filemanager",function(e,i){function n(i){0===e.settings.external_filemanager_path.toLowerCase().indexOf(i.origin.toLowerCase())&&"responsivefilemanager"===i.data.sender&&(tinymce.activeEditor.windowManager.getParams().setUrl(i.data.url),tinymce.activeEditor.windowManager.close(),window.removeEventListener?window.removeEventListener("message",n,!1):window.detachEvent("onmessage",n))}function a(i,a,t){var s=window.innerWidth-30,r=window.innerHeight-60;(s>1800&&(s=1800),r>1200&&(r=1200),s>600)&&(s=s-(s-20)%138+10);urltype=2,"image"!==t.filetype&&"image"!==t.mediaType||(urltype=1),"media"!==t.filetype&&"media"!==t.mediaType||(urltype=3);var g="RESPONSIVE FileManager";void 0!==e.settings.filemanager_title&&e.settings.filemanager_title&&(g=e.settings.filemanager_title);var o="key";void 0!==e.settings.filemanager_access_key&&e.settings.filemanager_access_key&&(o=e.settings.filemanager_access_key);var l="";void 0!==e.settings.filemanager_sort_by&&e.settings.filemanager_sort_by&&(l="&sort_by="+e.settings.filemanager_sort_by);var d=0;void 0!==e.settings.filemanager_descending&&e.settings.filemanager_descending&&(d=e.settings.filemanager_descending);var m="";void 0!==e.settings.filemanager_subfolder&&e.settings.filemanager_subfolder&&(m="&fldr="+e.settings.filemanager_subfolder);var f="";void 0!==e.settings.filemanager_crossdomain&&e.settings.filemanager_crossdomain&&(f="&crossdomain=1",window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent("onmessage",n)),window.addEventListener("message",function e(n){window.removeEventListener("message",e,!1),"responsivefilemanager"===n.data.sender&&i(n.data.url)},!1);var c=e.settings.external_filemanager_path+"?type="+urltype+"&descending="+d+l+m+f+"&lang="+e.settings.language+"&akey="+o;tinymce.majorVersion>4?tinymce.activeEditor.windowManager.openUrl({title:g,url:c,width:s,height:r,resizable:!0,maximizable:!0,inline:1}):tinymce.activeEditor.windowManager.open({title:g,file:c,width:s,height:r,resizable:!0,maximizable:!0,inline:1})}return e.settings.file_picker_types="file image media",e.settings.file_picker_callback=a,e.ui.registry.addButton("responsivefilemanager",{icon:"browse",onAction:function(){a((e,i)=>(console.log(e,i),!1),null,"file")}}),!1});
